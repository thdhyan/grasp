# Training configuration for GQ-CNN PyTorch
# This configuration is designed for training a parallel jaw GQ-CNN

# Training mode
training_mode: classification

# GQ-CNN model configuration
gqcnn:
  # Image parameters
  im_height: 32
  im_width: 32
  im_channels: 1
  batch_size: 64

  # Gripper mode
  gripper_mode: parallel_jaw

  # Input depth mode
  input_depth_mode: pose_stream

  # Normalization parameters
  radius: 2
  alpha: 2.0e-05
  beta: 0.75
  bias: 1.0

  # Activation
  relu_coeff: 0.0

  # Debug settings
  debug: false
  seed: 42

  # Network architecture
  architecture:
    im_stream:
      conv1_1:
        type: conv
        filt_dim: 7
        num_filt: 64
        pool_size: 1
        pool_stride: 1
        pad: VALID
        norm: true
      conv1_2:
        type: conv
        filt_dim: 5
        num_filt: 64
        pool_size: 2
        pool_stride: 2
        pad: VALID
        norm: false
      conv2_1:
        type: conv
        filt_dim: 3
        num_filt: 64
        pool_size: 1
        pool_stride: 1
        pad: VALID
        norm: false
      conv2_2:
        type: conv
        filt_dim: 3
        num_filt: 64
        pool_size: 2
        pool_stride: 2
        pad: VALID
        norm: false
      fc3:
        type: fc
        out_size: 1024
    pose_stream:
      pc1:
        type: pc
        out_size: 16
    merge_stream:
      fc4:
        type: fc_merge
        out_size: 1024
      fc5:
        type: fc
        out_size: 2

# Training parameters
training:
  # Batch size (same as gqcnn config)
  batch_size: 64

  # Number of epochs
  num_epochs: 50

  # Learning rate
  learning_rate: 0.001
  lr_decay_rate: 0.95
  lr_decay_step: 10000

  # Optimizer parameters
  momentum: 0.9
  weight_decay: 0.0005

  # Dropout
  drop_rate: 0.0

  # Logging and checkpointing
  log_frequency: 100
  val_frequency: 1000
  save_frequency: 5000

  # Early stopping
  early_stopping_patience: 10
